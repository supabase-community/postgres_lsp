<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://pglt.github.io/rules/adding-required-field/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>addingRequiredField - Postgres Language Tools</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "addingRequiredField";
        var mkdocs_page_input_path = "rules/adding-required-field.md";
        var mkdocs_page_url = "/rules/adding-required-field/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Postgres Language Tools
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Introduction</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Guides</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../linting_migrations/">Linting Migrations</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../">Rules</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../rule_sources/">Rule Sources</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cli_reference/">CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../env_variables/">Environment Variables</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Postgres Language Tools</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">addingRequiredField</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/supabase-community/postgres_lsp/edit/master/docs/rules/adding-required-field.md">Edit on supabase-community/postgres_lsp</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="addingrequiredfield">addingRequiredField</h1>
<p><strong>Diagnostic Category: <code>lint/safety/addingRequiredField</code></strong></p>
<p><strong>Since</strong>: <code>vnext</code></p>
<p><strong>Sources</strong>: 
- Inspired from: <a href="https://squawkhq.com/docs/adding-required-field" target="_blank"><code>squawk/adding-required-field</code></a></p>
<h2 id="description">Description</h2>
<p>Adding a new column that is NOT NULL and has no default value to an existing table effectively makes it required.</p>
<p>This will fail immediately upon running for any populated table. Furthermore, old application code that is unaware of this column will fail to INSERT to this table.</p>
<p>Make new columns optional initially by omitting the NOT NULL constraint until all existing data and application code has been updated. Once no NULL values are written to or persisted in the database, set it to NOT NULL.
Alternatively, if using Postgres version 11 or later, add a DEFAULT value that is not volatile. This allows the column to keep its NOT NULL constraint.</p>
<h2 id="invalid">Invalid</h2>
<p>alter table test add column count int not null;</p>
<h2 id="valid-in-postgres-11">Valid in Postgres &gt;= 11</h2>
<p>alter table test add column count int not null default 0;</p>
<h2 id="how-to-configure">How to configure</h2>
<pre><code class="language-toml">[linter.rules.safety]
addingRequiredField = &quot;error&quot;

</code></pre>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/supabase-community/postgres_lsp" class="fa fa-code-fork" style="color: #fcfcfc"> supabase-community/postgres_lsp</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
